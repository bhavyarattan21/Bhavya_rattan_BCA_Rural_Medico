<!DOCTYPE html>
<html>

<head>
    <title>Login & Registration</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: url('../ALL\ IMAGES/background.jpg') no-repeat center center/cover;

            transition: background 1s ease-in-out;
            padding: 20px;
            background-image: url(../ALL\ IMAGES/login.1.jpg);
        }

        .container {
            position: relative;
            width: 100%;
            max-width: 400px;
            padding: 20px;
        }

        .form-container {
            background: rgba(255, 255, 255, 0.3);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            text-align: center;
            backdrop-filter: blur(10px);
            transition: transform 0.5s ease-in-out, opacity 0.5s ease-in-out;
            opacity: 0;
            animation: fadeIn 1s forwards;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: scale(0.8);
            }

            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .form-container h2 {
            margin-bottom: 15px;
            transition: color 0.3s ease-in-out;
        }

        .input-group {
            position: relative;
            margin-bottom: 15px;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: all 0.3s ease-in-out;
            outline: none;
        }

        .input-group label {
            position: absolute;
            top: 50%;
            left: 10px;
            transform: translateY(-50%);
            background: white;
            padding: 0 5px;
            font-size: 14px;
            color: gray;
            transition: 0.3s ease-in-out;
        }

        .input-group input:focus+label,
        .input-group input:not(:placeholder-shown)+label,
        .input-group select:focus+label,
        .input-group select:not([value=""])+label {
            top: 0;
            left: 10px;
            font-size: 12px;
            color: #28a745;
        }

        .form-container button {
            width: 100%;
            padding: 10px;
            background: #28a745;
            border: none;
            color: white;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease-in-out, transform 0.2s ease-in-out;
        }

        .form-container button:hover {
            background: #218838;
            transform: scale(1.05);
        }

        .toggle-link {
            margin-top: 15px;
            cursor: pointer;
            color: #007bff;
            transition: color 0.3s;
        }

        .toggle-link:hover {
            color: #0056b3;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="form-container" id="login-form">
            <h2>Welcome Back</h2>
            <form onsubmit="loginUser(event)">
                <div class="input-group">
                    <input type="email" name="email" required>
                    <label>Email Address</label>
                </div>
                <div class="input-group">
                    <input type="password" name="password" required>
                    <label>Enter Password</label>
                </div>
                <button type="submit">Sign In</button>
            </form>
            <p class="toggle-link" onclick="toggleForm()">New here? Create an account</p>
        </div>

        <div class="form-container" id="signup-form" style="display: none;">
            <h2>Create Your Account</h2>
            <form onsubmit="registerUser(event)">
                <div class="input-group">
                    <input type="text" name="full_name" required>
                    <label>Full Name</label>
                </div>
                <div class="input-group">
                    <input type="tel" name="phone_number" required>
                    <label>Phone Number</label>
                </div>
                <div class="input-group">
                    <input type="email" name="email" required>
                    <label>Email Address</label>
                </div>
                <div class="input-group">
                    <input type="password" name="password" required>
                    <label>Create Password</label>
                </div>
                <div class="input-group">
                    <select name="state" required>
                        <option value="">Select State</option>
                        <option value="Arunachal Pradesh ">Arunachal Pradesh</option>
                        <option value="Assam">Assam</option>
                        <option value="Bihar">Bihar</option>
                        <option value="Chhattisgarh">Chhattisgarh</option>
                        <option value="Delhi">Delhi</option>
                        <option value="Goa">Goa</option>
                        <option value="Gujarat">Gujarat</option>
                        <option value="Haryana">Haryana</option>
                        <option value="Himachal Pradesh">Himachal Pradesh</option>
                        <option value="Jharkhand">Jharkhand</option>
                        <option value="Karnataka">Karnataka</option>
                        <option value="Kerala">Kerala</option>
                        <option value="Madhya Pradesh">Madhya Pradesh</option>
                        <option value="Maharashtra">Maharashtra</option>
                        <option value="Manipur">Manipur</option>
                        <option value="Meghalaya">Meghalaya</option>
                        <option value="Mizoram">Mizoram</option>
                        <option value="Nagaland">Nagaland</option>
                        <option value="Odisha">Odisha</option>
                        <option value="Punjab">Punjab</option>
                        <option value="Rajasthan">Rajasthan</option>
                        <option value="Sikkim">Sikkim</option>
                        <option value="Tamil Nadu">Tamil Nadu</option>
                        <option value="Telangana">Telangana</option>
                        <option value="Tripura">Tripura</option>
                        <option value="Uttar Pradesh">Uttar Pradesh</option>
                        <option value="Uttarakhand">Uttarakhand</option>
                        <option value="West Bengal">West Bengal</option>
                    </select>
                    <label>State</label>
                </div>
                <button type="submit">Register</button>
            </form>
            <p class="toggle-link" onclick="toggleForm()">Already have an account? Sign In</p>
        </div>
    </div>


    <script>
        function toggleForm() {
            const loginForm = document.getElementById("login-form");
            const signupForm = document.getElementById("signup-form");
            loginForm.style.display = loginForm.style.display === "none" ? "block" : "none";
            signupForm.style.display = signupForm.style.display === "none" ? "block" : "none";
        }

        function redirectToHome(event) {
            event.preventDefault();
            document.body.style.opacity = "0";
            setTimeout(() => {
                window.location.href = "../index.html";
            }, 700);
        }

        window.onload = () => {
            document.body.style.opacity = "1";
        };

        async function registerUser(event) {
            event.preventDefault();
            const form = event.target;
            try {
                const data = {
                    full_name: form.elements.full_name.value,
                    phone_number: form.elements.phone_number.value,
                    email: form.elements.email.value,
                    password: form.elements.password.value,
                    state: form.elements.state.value
                };

                const res = await fetch('http://localhost:3000/register', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const json = await res.json();
                if (!res.ok) throw new Error(json.message || 'Registration failed');

                alert('Registration successful! Please login.');
                toggleForm();
                form.reset();
            } catch (error) {
                console.error('Registration error:', error);
                alert(error.message);
            }
        }

        async function loginUser(event) {
            event.preventDefault();
            const form = event.target;
            try {
                const data = {
                    email: form.elements.email.value,
                    password: form.elements.password.value
                };

                const res = await fetch('http://localhost:3000/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const json = await res.json();
                if (!res.ok) throw new Error(json.message || 'Login failed');

                // Store user information
                sessionStorage.setItem('userId', json.user.id);
                sessionStorage.setItem('userName', json.user.name);
                sessionStorage.setItem('userEmail', json.user.email);

                alert('Login successful!');
                window.location.href = 'appointment.html'; // Fixed typo in filename
            } catch (error) {
                console.error('Login error:', error);
                alert(error.message);
            }
        }
    </script>
</body>

</html>